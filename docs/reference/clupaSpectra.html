<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Hierarchical Cluster-Based Peak Alignment on a Spectra Object — clupaSpectra • ChemoSpec</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Hierarchical Cluster-Based Peak Alignment on a Spectra Object — clupaSpectra" />

<meta property="og:description" content="This function is a wrapper to several functions in the speaq package.
It implements the CluPA algorithm described in the reference." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChemoSpec</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">5.0.94</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ChemoSpec.pdf">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bryanhanson/ChemoSpec">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hierarchical Cluster-Based Peak Alignment on a Spectra Object</h1>
    <small class="dont-index">Source: <a href='https://github.com/bryanhanson/ChemoSpec/blob/master/R/clupaSpectra.R'><code>R/clupaSpectra.R</code></a></small>
    <div class="hidden name"><code>clupaSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function is a wrapper to several functions in the <span class="pkg">speaq</span> package.
It implements the CluPA algorithm described in the reference.</p>
    
    </div>

    <pre class="usage"><span class='fu'>clupaSpectra</span>(<span class='no'>spectra</span>, <span class='kw'>bT</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spectra</th>
      <td><p>An object of S3 class <code><a href='Spectra.html'>Spectra</a></code>.</p></td>
    </tr>
    <tr>
      <th>bT</th>
      <td><p>Numeric.  The baseline threshold. Defaults to five percent of the
range of the data, in <code>spectra$data</code>.  Passed to
<code>detectSpecPeaks</code>.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Other arguments to be passed to the underlying functions.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A modifed <code><a href='Spectra.html'>Spectra</a></code> object.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Vu TN, Valkenborg D, Smets K, Verwaest KA, Dommisse R, Lemiere F, Verschoren
A, Goethals B, Laukens K. "An integrated workflow for robust alignment and
simplified quantitative analysis of NMR spectrometry data" BMC
Bioinformatics vol. 12 pg. 405 (2011).</p>
<p><a href='https://github.com/bryanhanson/ChemoSpec'>https://github.com/bryanhanson/ChemoSpec</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>data</span>(<span class='no'>alignMUD</span>)

<span class='fu'><a href='plotSpectra.html'>plotSpectra</a></span>(<span class='no'>alignMUD</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>20</span>, <span class='kw'>lab.pos</span> <span class='kw'>=</span> <span class='fl'>4.5</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>yrange</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1900</span>), <span class='kw'>amp</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1.5</span>, <span class='fl'>1.8</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Misaligned NMR Spectra (alignMUD)"</span>)</div><div class='img'><img src='clupaSpectra-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>aMUD</span> <span class='kw'>&lt;-</span> <span class='fu'>clupaSpectra</span>(<span class='no'>alignMUD</span>)</div><div class='output co'>#&gt; [1] "j =1 peak =292 savedpeak = 292"
#&gt; [1] "j =2 peak =164 savedpeak = 292"
#&gt; [1] "j =5 peak =370 savedpeak = 882"
#&gt; [1] "j =6 peak =242 savedpeak = 882"  "j =6 peak =367 savedpeak = 1007"
#&gt; [1] "j =7 peak =114 savedpeak = 882"  "j =7 peak =239 savedpeak = 1007"
#&gt; [1] "j =8 peak =111 savedpeak = 1007" "j =8 peak =316 savedpeak = 1212"
#&gt; 
#&gt;  Spectrum 1 has 4 peaks[1] "j =1 peak =291 savedpeak = 291"
#&gt; [1] "j =2 peak =163 savedpeak = 291"
#&gt; [1] "j =5 peak =369 savedpeak = 881"
#&gt; [1] "j =6 peak =241 savedpeak = 881" "j =6 peak =357 savedpeak = 997"
#&gt; [1] "j =7 peak =113 savedpeak = 881" "j =7 peak =229 savedpeak = 997"
#&gt; [1] "j =8 peak =101 savedpeak = 997"  "j =8 peak =315 savedpeak = 1211"
#&gt; 
#&gt;  Spectrum 2 has 4 peaks[1] "j =1 peak =294 savedpeak = 294"
#&gt; [1] "j =2 peak =166 savedpeak = 294"
#&gt; [1] "j =5 peak =372 savedpeak = 884"
#&gt; [1] "j =6 peak =244 savedpeak = 884"  "j =6 peak =360 savedpeak = 1000"
#&gt; [1] "j =7 peak =116 savedpeak = 884"  "j =7 peak =232 savedpeak = 1000"
#&gt; [1] "j =8 peak =104 savedpeak = 1000" "j =8 peak =318 savedpeak = 1214"
#&gt; 
#&gt;  Spectrum 3 has 4 peaks[1] "j =1 peak =294 savedpeak = 294"
#&gt; [1] "j =2 peak =166 savedpeak = 294"
#&gt; [1] "j =5 peak =372 savedpeak = 884"
#&gt; [1] "j =6 peak =244 savedpeak = 884"  "j =6 peak =369 savedpeak = 1009"
#&gt; [1] "j =7 peak =116 savedpeak = 884"  "j =7 peak =241 savedpeak = 1009"
#&gt; [1] "j =8 peak =113 savedpeak = 1009" "j =8 peak =318 savedpeak = 1214"
#&gt; 
#&gt;  Spectrum 4 has 4 peaks[1] "j =1 peak =290 savedpeak = 290"
#&gt; [1] "j =2 peak =162 savedpeak = 290"
#&gt; [1] "j =5 peak =368 savedpeak = 880"
#&gt; [1] "j =6 peak =240 savedpeak = 880"  "j =6 peak =365 savedpeak = 1005"
#&gt; [1] "j =7 peak =112 savedpeak = 880"  "j =7 peak =237 savedpeak = 1005"
#&gt; [1] "j =8 peak =109 savedpeak = 1005" "j =8 peak =314 savedpeak = 1210"
#&gt; 
#&gt;  Spectrum 5 has 4 peaks[1] "j =1 peak =291 savedpeak = 291"
#&gt; [1] "j =2 peak =163 savedpeak = 291"
#&gt; [1] "j =5 peak =369 savedpeak = 881"
#&gt; [1] "j =6 peak =241 savedpeak = 881"  "j =6 peak =366 savedpeak = 1006"
#&gt; [1] "j =7 peak =113 savedpeak = 881"  "j =7 peak =238 savedpeak = 1006"
#&gt; [1] "j =8 peak =110 savedpeak = 1006" "j =8 peak =315 savedpeak = 1211"
#&gt; 
#&gt;  Spectrum 6 has 4 peaks[1] "j =1 peak =291 savedpeak = 291"
#&gt; [1] "j =2 peak =163 savedpeak = 291"
#&gt; [1] "j =5 peak =369 savedpeak = 881"
#&gt; [1] "j =6 peak =241 savedpeak = 881"  "j =6 peak =366 savedpeak = 1006"
#&gt; [1] "j =7 peak =113 savedpeak = 881"  "j =7 peak =238 savedpeak = 1006"
#&gt; [1] "j =8 peak =110 savedpeak = 1006" "j =8 peak =315 savedpeak = 1211"
#&gt; 
#&gt;  Spectrum 7 has 4 peaks[1] "j =1 peak =293 savedpeak = 293"
#&gt; [1] "j =2 peak =165 savedpeak = 293"
#&gt; [1] "j =5 peak =371 savedpeak = 883"
#&gt; [1] "j =6 peak =243 savedpeak = 883"  "j =6 peak =368 savedpeak = 1008"
#&gt; [1] "j =7 peak =115 savedpeak = 883"  "j =7 peak =240 savedpeak = 1008"
#&gt; [1] "j =8 peak =112 savedpeak = 1008" "j =8 peak =317 savedpeak = 1213"
#&gt; 
#&gt;  Spectrum 8 has 4 peaks[1] "j =1 peak =295 savedpeak = 295"
#&gt; [1] "j =2 peak =167 savedpeak = 295"
#&gt; [1] "j =5 peak =373 savedpeak = 885"
#&gt; [1] "j =6 peak =245 savedpeak = 885"  "j =6 peak =370 savedpeak = 1010"
#&gt; [1] "j =7 peak =117 savedpeak = 885"  "j =7 peak =242 savedpeak = 1010"
#&gt; [1] "j =8 peak =114 savedpeak = 1010" "j =8 peak =319 savedpeak = 1215"
#&gt; 
#&gt;  Spectrum 9 has 4 peaks[1] "j =1 peak =293 savedpeak = 293"
#&gt; [1] "j =2 peak =165 savedpeak = 293"
#&gt; [1] "j =5 peak =371 savedpeak = 883"
#&gt; [1] "j =6 peak =243 savedpeak = 883" "j =6 peak =359 savedpeak = 999"
#&gt; [1] "j =7 peak =115 savedpeak = 883" "j =7 peak =231 savedpeak = 999"
#&gt; [1] "j =8 peak =103 savedpeak = 999"  "j =8 peak =317 savedpeak = 1213"
#&gt; 
#&gt;  Spectrum 10 has 4 peaks[1] "j =1 peak =294 savedpeak = 294"
#&gt; [1] "j =2 peak =166 savedpeak = 294"
#&gt; [1] "j =5 peak =372 savedpeak = 884"
#&gt; [1] "j =6 peak =244 savedpeak = 884"  "j =6 peak =369 savedpeak = 1009"
#&gt; [1] "j =7 peak =116 savedpeak = 884"  "j =7 peak =241 savedpeak = 1009"
#&gt; [1] "j =8 peak =113 savedpeak = 1009" "j =8 peak =318 savedpeak = 1214"
#&gt; 
#&gt;  Spectrum 11 has 4 peaks[1] "j =1 peak =294 savedpeak = 294"
#&gt; [1] "j =2 peak =166 savedpeak = 294"
#&gt; [1] "j =5 peak =372 savedpeak = 884"
#&gt; [1] "j =6 peak =244 savedpeak = 884"  "j =6 peak =369 savedpeak = 1009"
#&gt; [1] "j =7 peak =116 savedpeak = 884"  "j =7 peak =241 savedpeak = 1009"
#&gt; [1] "j =8 peak =113 savedpeak = 1009" "j =8 peak =318 savedpeak = 1214"
#&gt; 
#&gt;  Spectrum 12 has 4 peaks[1] "j =1 peak =291 savedpeak = 291"
#&gt; [1] "j =2 peak =163 savedpeak = 291"
#&gt; [1] "j =5 peak =369 savedpeak = 881"
#&gt; [1] "j =6 peak =241 savedpeak = 881"  "j =6 peak =366 savedpeak = 1006"
#&gt; [1] "j =7 peak =113 savedpeak = 881"  "j =7 peak =238 savedpeak = 1006"
#&gt; [1] "j =8 peak =110 savedpeak = 1006" "j =8 peak =315 savedpeak = 1211"
#&gt; 
#&gt;  Spectrum 13 has 4 peaks[1] "j =1 peak =295 savedpeak = 295"
#&gt; [1] "j =2 peak =167 savedpeak = 295"
#&gt; [1] "j =5 peak =373 savedpeak = 885"
#&gt; [1] "j =6 peak =245 savedpeak = 885"  "j =6 peak =361 savedpeak = 1001"
#&gt; [1] "j =7 peak =117 savedpeak = 885"  "j =7 peak =233 savedpeak = 1001"
#&gt; [1] "j =8 peak =105 savedpeak = 1001" "j =8 peak =319 savedpeak = 1215"
#&gt; 
#&gt;  Spectrum 14 has 4 peaks[1] "j =1 peak =293 savedpeak = 293"
#&gt; [1] "j =2 peak =165 savedpeak = 293"
#&gt; [1] "j =5 peak =371 savedpeak = 883"
#&gt; [1] "j =6 peak =243 savedpeak = 883"  "j =6 peak =368 savedpeak = 1008"
#&gt; [1] "j =7 peak =115 savedpeak = 883"  "j =7 peak =240 savedpeak = 1008"
#&gt; [1] "j =8 peak =112 savedpeak = 1008" "j =8 peak =317 savedpeak = 1213"
#&gt; 
#&gt;  Spectrum 15 has 4 peaks[1] "j =1 peak =294 savedpeak = 294"
#&gt; [1] "j =2 peak =166 savedpeak = 294"
#&gt; [1] "j =5 peak =372 savedpeak = 884"
#&gt; [1] "j =6 peak =244 savedpeak = 884"  "j =6 peak =360 savedpeak = 1000"
#&gt; [1] "j =7 peak =116 savedpeak = 884"  "j =7 peak =232 savedpeak = 1000"
#&gt; [1] "j =8 peak =104 savedpeak = 1000" "j =8 peak =318 savedpeak = 1214"
#&gt; 
#&gt;  Spectrum 16 has 4 peaks[1] "j =1 peak =293 savedpeak = 293"
#&gt; [1] "j =2 peak =165 savedpeak = 293"
#&gt; [1] "j =5 peak =371 savedpeak = 883"
#&gt; [1] "j =6 peak =243 savedpeak = 883"  "j =6 peak =368 savedpeak = 1008"
#&gt; [1] "j =7 peak =115 savedpeak = 883"  "j =7 peak =240 savedpeak = 1008"
#&gt; [1] "j =8 peak =112 savedpeak = 1008" "j =8 peak =317 savedpeak = 1213"
#&gt; 
#&gt;  Spectrum 17 has 4 peaks[1] "j =1 peak =291 savedpeak = 291"
#&gt; [1] "j =2 peak =163 savedpeak = 291"
#&gt; [1] "j =5 peak =369 savedpeak = 881"
#&gt; [1] "j =6 peak =241 savedpeak = 881"  "j =6 peak =366 savedpeak = 1006"
#&gt; [1] "j =7 peak =113 savedpeak = 881"  "j =7 peak =238 savedpeak = 1006"
#&gt; [1] "j =8 peak =110 savedpeak = 1006" "j =8 peak =315 savedpeak = 1211"
#&gt; 
#&gt;  Spectrum 18 has 4 peaks[1] "j =1 peak =294 savedpeak = 294"
#&gt; [1] "j =2 peak =166 savedpeak = 294"
#&gt; [1] "j =5 peak =372 savedpeak = 884"
#&gt; [1] "j =6 peak =244 savedpeak = 884"  "j =6 peak =369 savedpeak = 1009"
#&gt; [1] "j =7 peak =116 savedpeak = 884"  "j =7 peak =241 savedpeak = 1009"
#&gt; [1] "j =8 peak =113 savedpeak = 1009" "j =8 peak =318 savedpeak = 1214"
#&gt; 
#&gt;  Spectrum 19 has 4 peaks[1] "j =1 peak =291 savedpeak = 291"
#&gt; [1] "j =2 peak =163 savedpeak = 291"
#&gt; [1] "j =5 peak =369 savedpeak = 881"
#&gt; [1] "j =6 peak =241 savedpeak = 881" "j =6 peak =357 savedpeak = 997"
#&gt; [1] "j =7 peak =113 savedpeak = 881" "j =7 peak =229 savedpeak = 997"
#&gt; [1] "j =8 peak =101 savedpeak = 997"  "j =8 peak =315 savedpeak = 1211"
#&gt; 
#&gt;  Spectrum 20 has 4 peaks
#&gt;  --------------------------------
#&gt;  CluPA will run with maxShift= 100
#&gt;  If you want CluPA automatically detect the optimal maxShift,
#&gt;  let try with dohCluster(...,maxShift=NULL,..)
#&gt;  --------------------------------
#&gt; 
#&gt;  aligning spectrum  1
#&gt;  aligning spectrum  2
#&gt;  aligning spectrum  3
#&gt;  aligning spectrum  4
#&gt;  aligning spectrum  5
#&gt;  aligning spectrum  6
#&gt;  aligning spectrum  7
#&gt;  aligning spectrum  9
#&gt;  aligning spectrum  10
#&gt;  aligning spectrum  11
#&gt;  aligning spectrum  12
#&gt;  aligning spectrum  13
#&gt;  aligning spectrum  14
#&gt;  aligning spectrum  15
#&gt;  aligning spectrum  16
#&gt;  aligning spectrum  17
#&gt;  aligning spectrum  18
#&gt;  aligning spectrum  19
#&gt;  aligning spectrum  20
#&gt;  Median pearson correlation of aligned spectra: 0.9999948
#&gt;  Alignment time:  0.001  minutes</div><div class='input'><span class='fu'><a href='plotSpectra.html'>plotSpectra</a></span>(<span class='no'>aMUD</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>20</span>, <span class='kw'>lab.pos</span> <span class='kw'>=</span> <span class='fl'>4.5</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>yrange</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>1900</span>), <span class='kw'>amp</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1.5</span>, <span class='fl'>1.8</span>),
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"Aligned NMR Spectra (alignMUD)"</span>)</div><div class='img'><img src='clupaSpectra-2.png' alt='' width='700' height='433' /></div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Bryan A. Hanson, DePauw University. <a href='mailto:hanson@depauw.edu'>hanson@depauw.edu</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bryan A. Hanson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

